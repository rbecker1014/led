<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>LED Arch Calculator</title><style>:root{--bg:#0b0f14;--card:#111826;--text:#e7eef8;--muted:#9fb2cc;--tubeA:rgba(96,165,250,.30);--tubeB:rgba(52,211,153,.30);--join:rgba(244,114,182,.95);--strip:rgba(253,224,71,.55);--warn:rgba(251,146,60,.18);--warn2:rgba(251,146,60,.85)}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text)}.wrap{max-width:1220px;margin:24px auto;padding:0 16px;display:grid;grid-template-columns:560px 1fr;gap:16px}.card{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.25)}h1{font-size:18px;margin:0 0 10px}.sub{color:var(--muted);font-size:13px;line-height:1.35;margin:0 0 14px}label{display:block;font-size:13px;color:var(--muted);margin-top:12px}input,select{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:#0c1422;color:var(--text);font-size:14px}input[type=range]{padding:0;height:34px}.row{display:grid;grid-template-columns:1fr 1fr;gap:10px}.row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}.results{margin-top:14px;border-top:1px solid rgba(255,255,255,.08);padding-top:14px}.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}.k{color:var(--muted);font-size:12px}.v{font-size:15px;font-weight:700;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}.note{margin-top:12px;padding:10px 12px;border-radius:10px;background:rgba(255,255,255,.06);color:var(--muted);font-size:12px;line-height:1.35}.warn{margin-top:10px;padding:10px 12px;border-radius:10px;background:var(--warn);border:1px solid rgba(251,146,60,.22);color:rgba(255,255,255,.86);font-size:12px;line-height:1.35}.warn b{color:var(--warn2)}svg{width:100%;height:560px;display:block;background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));border-radius:14px;border:1px solid rgba(255,255,255,.08)}</style></head>
<body>
<div class="wrap">
  <div class="card">
    <h1>LED Arch Calculator</h1>
    <p class="sub">Natural bend with smoothness-first or length-first solving. Heat map shows curvature concentration.</p>

    <label>Width (W)</label><input id="width" type="number" value="10" step="0.01">
    <label>Height (H)</label><input id="height" type="number" value="6" step="0.01">

    <label>Prefer smoothness</label>
    <input id="preferSmooth" type="checkbox" checked>

    <label>Tubing length (L)</label>
    <input id="tubeLen" placeholder="auto">

    <label>Curvature heat map</label>
    <select id="heat"><option value="on">On</option><option value="off">Off</option></select>

    <div class="results">
      <div class="grid">
        <div><div class="k">Length used</div><div id="length" class="v">—</div></div>
        <div><div class="k">Curvature concentration</div><div id="conc" class="v">—</div></div>
      </div>
      <div id="warnBox" class="warn" style="display:none;"></div>
    </div>
  </div>

  <div class="card">
    <svg id="svg" viewBox="0 0 920 560">
      <path id="tube" fill="none" stroke="var(--tubeA)" stroke-width="12"/>
    </svg>
  </div>
</div>

<script>
(() => {
  const $ = id => document.getElementById(id);
  const W = $('width'), H = $('height'), L = $('tubeLen'),
        smooth = $('preferSmooth'), heat = $('heat');
  const lenOut = $('length'), concOut = $('conc'), warn = $('warnBox');
  const tube = $('tube'), svg = $('svg');

  const bezier = (W,H,dx,n=1000) => {
    const dy = 4*H/3, pts=[];
    for(let i=0;i<=n;i++){
      const t=i/n,mt=1-t;
      const x = (-W/2)*mt*mt*mt + 3*(-W/2+dx)*mt*mt*t + 3*(W/2-dx)*mt*t*t + (W/2)*t*t*t;
      const y = 0*mt*mt*mt + 3*dy*mt*mt*t + 3*dy*mt*t*t;
      pts.push({x,y});
    }
    return pts;
  };

  const curvature = pts => {
    const k=[];
    for(let i=1;i<pts.length-1;i++){
      const a=Math.hypot(pts[i].x-pts[i-1].x,pts[i].y-pts[i-1].y),
            b=Math.hypot(pts[i+1].x-pts[i].x,pts[i+1].y-pts[i].y),
            c=Math.hypot(pts[i+1].x-pts[i-1].x,pts[i+1].y-pts[i-1].y);
      const area=Math.abs((pts[i].x-pts[i-1].x)*(pts[i+1].y-pts[i-1].y)-(pts[i].y-pts[i-1].y)*(pts[i+1].x-pts[i-1].x))/2;
      k.push(2*area/(a*b*c||1));
    }
    return k;
  };

  const update = () => {
    const w=+W.value,h=+H.value;
    const pts = bezier(w,h,w*0.28);
    const k = curvature(pts);
    const q50=k.sort((a,b)=>a-b)[Math.floor(k.length*.5)];
    const q95=k[Math.floor(k.length*.95)];
    const conc=q95/q50;

    lenOut.textContent = pts.length.toFixed(0);
    concOut.textContent = conc.toFixed(2)+'×';

    warn.style.display = !smooth.checked && conc>1.25?'block':'none';
    warn.innerHTML = '<b>Warning:</b> curvature concentrated';

    const vb=svg.viewBox.baseVal;
    const px=x=>vb.width/2 + x*(vb.width/(w*1.2));
    const py=y=>vb.height*.85 - y*(vb.height/(h*1.2));

    tube.setAttribute('d','M '+pts.map(p=>px(p.x)+','+py(p.y)).join(' L '));
  };

  ['input','change'].forEach(e=>{
    [W,H,L,smooth,heat].forEach(el=>el.addEventListener(e,update))
  });

  update();
})();
</script>
</body></html>
